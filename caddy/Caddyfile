{$SITE_DOMAIN} {
	encode gzip zstd
	
	@api {
		path /api/*
	}
	
	@uploads {
		path /uploads/*
	}
	
	handle @uploads {
		root * /var/www/html/public
		file_server
	}
	
	handle @api {
		reverse_proxy symfony:80
	}
	
	handle {
		reverse_proxy nuxt:3000
	}

	handle_path /xhttp-path* {
        reverse_proxy h2c://127.0.0.1:10000 {
            transport http {
                versions h2c 2
            }
            flush_interval -1
        }
    }
	
	header {
		X-Frame-Options "DENY"
		X-Content-Type-Options "nosniff"
		Referrer-Policy "strict-origin-when-cross-origin"
	}
	
	log {
		output file /var/log/caddy/access.log
		format console
	}

}

